% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main_v2.R
\name{local_GENIE}
\alias{local_GENIE}
\title{Local Generative Network-Integrated Evaluation (local_GENIE)}
\usage{
local_GENIE(
  items,
  embedding.model = "bert-base-uncased",
  device = "auto",
  batch.size = 32,
  pooling.strategy = "mean",
  max.length = 512,
  EGA.model = NULL,
  EGA.algorithm = NULL,
  EGA.uni.method = NULL,
  embeddings.only = FALSE,
  run.overall = FALSE,
  all.together = FALSE,
  plot = TRUE,
  silently = FALSE
)
}
\arguments{
\item{items}{Data frame with columns: statement, attribute, type, ID.
All columns must be character type except ID (numeric or character allowed).
\itemize{
\item \code{statement}: The actual item text
\item \code{attribute}: The construct/attribute the item measures
\item \code{type}: The item type/category
\item \code{ID}: Unique identifier for each item
}}

\item{embedding.model}{Local embedding model identifier or path. Compatible models:
\itemize{
\item BERT variants: "bert-base-uncased", "bert-large-uncased"
\item RoBERTa: "roberta-base", "roberta-large"
\item DeBERTa: "microsoft/deberta-v3-base", "microsoft/deberta-v3-large"
\item DistilBERT: "distilbert-base-uncased"
\item Local paths: e.g., "/path/to/local/model"
}}

\item{device}{Device for embedding computation:
\itemize{
\item "auto": Automatically detect best available device
\item "cpu": Force CPU usage
\item "cuda": Use NVIDIA GPU (if available)
\item "mps": Use Apple Silicon GPU (if available)
}}

\item{batch.size}{Number of items to process simultaneously (default: 32)}

\item{pooling.strategy}{Method for pooling token embeddings:
\itemize{
\item "mean": Average all token embeddings (default)
\item "cls": Use only the CLS token embedding
\item "max": Max pooling across tokens
}}

\item{max.length}{Maximum sequence length for tokenization (default: 512)}

\item{EGA.model}{Network estimation model ("glasso", "TMFG", or NULL for auto-selection)}

\item{EGA.algorithm}{Community detection algorithm ("walktrap", "leiden", "louvain")}

\item{EGA.uni.method}{Unidimensionality assessment method ("louvain", "expand", "LE")}

\item{embeddings.only}{If \code{TRUE}, return embeddings and stop (skip network analysis)}

\item{run.overall}{A logical value (optional, default: FALSE). Controls whether a \emph{fit} analysis
on the complete item pool is run \emph{post-reduction.}
By default, only type-level reduction analyses are run (i.e., items of like-type go through
the pipeline independent of the other items in the pool). When this flag is \code{TRUE}, an additional
analysis is run on the overall sample, but no further reductions at the overall level are made.
If only one item type is present, this argument will be ignored.}

\item{all.together}{A logical value (optional, default: FALSE). Controls whether the \emph{reduction} analysis
on the complete item pool is run.
By default, only type-level reduction analyses are run (i.e., items of like-type go through
the pipeline independent of the other items in the pool). When this flag is \code{TRUE}, reductions are made
at the overall level (i.e., all items go through the reduction pipeline together, agnostic of item type).
If only one item type is present, this argument will be ignored.}

\item{plot}{If \code{TRUE}, display network comparison plots}

\item{silently}{If \code{TRUE}, suppress progress messages

\strong{Defaults:} \code{items.only = FALSE}, \code{embeddings.only = FALSE},
\code{run.overall = FALSE}, \code{all.together = FALSE}.

\strong{When \code{items.only = TRUE}:}
Returns a \code{data.frame} of generated items with columns:
\code{ID}, \code{statement}, \code{type}, and \code{attribute}.

\strong{When \code{embeddings.only = TRUE}:}
Returns a named \code{list} with two elements:
\itemize{
\item \code{embeddings} — an embedding matrix/list (columns or rownames correspond to item IDs).
\item \code{items} — the items \code{data.frame} described above.
}

\strong{Default behaviour} (\code{items.only = FALSE}, \code{embeddings.only = FALSE},
\code{run.overall = FALSE}, \code{all.together = FALSE}):
Returns a named \code{list} with two top-level elements:
\describe{
\item{\code{item_type_level}}{A named list where each name is an item type and each element is a per-type named list containing:
\describe{
\item{\code{final_NMI}}{Numeric: final normalized mutual information after reduction.}
\item{\code{initial_NMI}}{Numeric: initial NMI of the pre-reduced item pool.}
\item{\code{embeddings}}{List or matrix of embeddings for this item type (see 'Notes on \code{embeddings}' below).}
\item{\code{UVA}}{List from Unique Variable Analysis (contains at least \code{n_removed}, \code{n_sweeps}, \code{redundant_pairs} data.frame).}
\item{\code{bootEGA}}{List with bootEGA results (e.g. \code{initial_boot}, \code{final_boot}, \code{n_removed}, \code{items_removed}, \code{initial_boot_with_redundancies}).}
\item{\code{EGA.model_selected}}{Character: chosen EGA model (e.g. \code{"TMFG"} or \code{"Glasso"}).}
\item{\code{final_items}}{\code{data.frame}: final items after reduction (columns include \code{ID}, \code{statement}, \code{attribute}, \code{type}, \code{EGA_com}).}
\item{\code{final_EGA}}{EGA object (from EGAnet) after reduction.}
\item{\code{initial_EGA}}{Initial EGA object computed on the pre-reduced item set.}
\item{\code{start_N}}{Integer: initial number of items in this type.}
\item{\code{final_N}}{Integer: final number of items in this type.}
\item{\code{network_plot}}{\code{ggplot} / \code{patchwork} object comparing networks before vs after reduction.}
\item{\code{stability_plot}}{\code{ggplot} / \code{patchwork} object showing item stability before vs after reduction.}
}
}

\item{\code{overall}}{Named list with aggregated results across all item types. Under the default this contains:
\describe{
\item{\code{final_items}}{\code{data.frame} of final items across all types (columns as above).}
\item{\code{embeddings}}{Embeddings for the full reduced item set (see 'Notes on \code{embeddings}' below). Note: \code{overall$embeddings} does \strong{not} include \code{selected}.}
}
}
}

\strong{When \code{run.overall = TRUE}} (\code{items.only = FALSE}, \code{embeddings.only = FALSE}):
\describe{
\item{\code{item_type_level}}{Same per-type structure as the default (see above).}
\item{\code{overall}}{A named list with aggregated results (not limited to \code{final_items} and \code{embeddings}) containing:
\code{final_NMI}, \code{initial_NMI}, \code{embeddings}, \code{EGA.model_selected}, \code{final_items}, \code{final_EGA}, \code{initial_EGA}, \code{start_N}, \code{final_N}, and \code{network_plot}.}
}

\strong{When \code{all.together = TRUE}} (regardless of \code{run.overall}):
Results are \strong{not} split into \code{item_type_level} and \code{overall}. Instead the function returns a single named list containing:
\code{final_NMI}, \code{initial_NMI}, \code{embeddings}, \code{UVA}, \code{bootEGA}, \code{EGA.model_selected}, \code{final_items}, \code{final_EGA}, \code{initial_EGA}, \code{start_N}, \code{final_N}, \code{network_plot}, and \code{stability_plot}.}
}
\description{
Local version of GENIE that uses locally installed embedding models for complete
privacy and offline operation. Provides the same psychometric validation and
quality assessment for user-supplied items as GENIE, but generates embeddings
locally using transformer models instead of API calls.
}
